<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <title>ACDuino web client</title>

    <!-- Main meta tags -->
    <meta name="description" content="">
    <meta name="author" content="Tomáš Vondra">
    <!--<meta name="robots" content="index, follow">-->
    <meta name="keywords" content="">
    <meta name="viewport"
          content="width=device-width, height=device-height, initial-scale=1, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0, shrink-to-fit=no">
    <link rel="stylesheet" href="./assets/css/style.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <style></style>
</head>

<body>
<div class="container login-container">
    <div class="row justify-content-md-center">
        <div class="col-12 col-md-5 pt-3 pb-3 rounded shadow-lg">
            <div class="text-center">
                <h3 class="mb-3">Login</h3>
                <div class="alert alert-danger alert-dismissible text-left fade" role="alert">
                    Vaše přihlašovací údaje <strong>nejsou správné</strong>
                    <button type="button" class="close" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="form-group">
                    <label for="username">Uživatelské jméno</label>
                    <input type="text" class="form-control text-center" id="username"
                           placeholder="Zadejte uživatelské jméno">
                </div>
                <div class="form-group">
                    <label for="password">Heslo</label>
                    <input type="password" class="form-control text-center" id="password"
                           placeholder="Heslo">
                </div>
                <button id="loginBtn" class="btn btn-primary" data-toggle="alert">Přihlásit se</button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    $(document).ready(function () {
        $(".alert").hide();
        $("#loginBtn").click(function () {
            var credentials = {username: $("#username").val(), password: $("#password").val()};
            console.log(credentials);
            $.ajax({
                url: 'http://localhost:8080/login',
                type: 'post',
                contentType: 'application/json',
                data: JSON.stringify(credentials)
            }).done(function (response, status, xhr) {
                var authToken = xhr.getResponseHeader("Authorization");
                document.cookie = "Authorization=" + authToken;
                window.location.replace("administration.html");
            }).fail(function (response) {
                $(".alert").addClass("show");
                $(".alert").show();
            });
        });

        $('.alert .close').on('click', function (e) {
            $(this).parent().hide();
        });
    });

</script>
</body>

</html>